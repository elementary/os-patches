<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>org.freedesktop.portal.Documents: Flatpak Library Reference Manual</title>
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot">
<link rel="home" href="index.html" title="Flatpak Library Reference Manual">
<link rel="up" href="ch02.html" title="D-Bus APIs">
<link rel="prev" href="gdbus-org.freedesktop.impl.portal.PermissionStore.html" title="org.freedesktop.impl.portal.PermissionStore">
<link rel="next" href="gdbus-org.freedesktop.portal.Flatpak.html" title="org.freedesktop.portal.Flatpak">
<meta name="generator" content="GTK-Doc V1.33.1 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts">
<a href="#" class="shortcut">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a href="#gdbus-org.freedesktop.portal.Documents.description" class="shortcut">Description</a></span><span id="nav_properties">  <span class="dim">|</span> 
                  <a href="#gdbus-org.freedesktop.portal.Documents.properties" class="shortcut">Properties</a></span>
</td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="ch02.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="gdbus-org.freedesktop.impl.portal.PermissionStore.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="gdbus-org.freedesktop.portal.Flatpak.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry">
<a name="gdbus-org.freedesktop.portal.Documents"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="gdbus-interface-org-freedesktop-portal-Documents.top_of_page"></a>org.freedesktop.portal.Documents</span></h2>
<p>org.freedesktop.portal.Documents — Document portal</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<h2>Methods</h2>
<pre class="synopsis">
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.GetMountPoint" title="The GetMountPoint() method">GetMountPoint</a>     (OUT ay     path);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.Add" title="The Add() method">Add</a>               (IN  h      o_path_fd,
                   IN  b      reuse_existing,
                   IN  b      persistent,
                   OUT s      doc_id);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.AddNamed" title="The AddNamed() method">AddNamed</a>          (IN  h      o_path_parent_fd,
                   IN  ay     filename,
                   IN  b      reuse_existing,
                   IN  b      persistent,
                   OUT s      doc_id);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.AddFull" title="The AddFull() method">AddFull</a>           (IN  ah     o_path_fds,
                   IN  u      flags,
                   IN  s      app_id,
                   IN  as     permissions,
                   OUT as     doc_ids,
                   OUT a{sv}  extra_out);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.AddNamedFull" title="The AddNamedFull() method">AddNamedFull</a>      (IN  h      o_path_fd,
                   IN  ay     filename,
                   IN  u      flags,
                   IN  s      app_id,
                   IN  as     permissions,
                   OUT s      doc_id,
                   OUT a{sv}  extra_out);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.GrantPermissions" title="The GrantPermissions() method">GrantPermissions</a>  (IN  s      doc_id,
                   IN  s      app_id,
                   IN  as     permissions);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.RevokePermissions" title="The RevokePermissions() method">RevokePermissions</a> (IN  s      doc_id,
                   IN  s      app_id,
                   IN  as     permissions);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.Delete" title="The Delete() method">Delete</a>            (IN  s      doc_id);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.Lookup" title="The Lookup() method">Lookup</a>            (IN  ay     filename,
                   OUT s      doc_id);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.Info" title="The Info() method">Info</a>              (IN  s      doc_id,
                   OUT ay     path,
                   OUT a{sas} apps);
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.List" title="The List() method">List</a>              (IN  s      app_id,
                   OUT a{say} docs);
</pre>
</div>
<div class="refsect1">
<a name="id-1.3.8.4"></a><h2>Properties</h2>
<pre class="synopsis">
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-property-org-freedesktop-portal-Documents.version" title='The "version" property'>version</a>  readable   u
</pre>
</div>
<div class="refsect1">
<a name="gdbus-interface-org-freedesktop-portal-Documents"></a><h2>Description</h2>
<p>
The document portal allows to make files from the outside world
available to sandboxed applications in a controlled way.
</p>
<p>
Exported files will be made accessible to the application via
a fuse filesystem that gets mounted at /run/user/$UID/doc/. The
filesystem gets mounted both outside and inside the sandbox, but
the view inside the sandbox is restricted to just those files
that the application is allowed to access.
</p>
<p>
Individual files will appear at /run/user/$UID/doc/$DOC_ID/filename,
where $DOC_ID is the ID of the file in the document store. It is
returned by the <a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.Add" title="The Add() method">Add()</a> and
<a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.AddNamed" title="The AddNamed() method">AddNamed()</a> calls.
</p>
<p>
The permissions that the application has for a document store entry
(see <a class="link" href="gdbus-org.freedesktop.portal.Documents.html#gdbus-method-org-freedesktop-portal-Documents.GrantPermissions" title="The GrantPermissions() method">GrantPermissions()</a>) are reflected
in the POSIX mode bits in the fuse filesystem.
</p>
<p>
The D-Bus interface for the document portal is available under the
bus name org.freedesktop.portal.Documents and the object path
/org/freedesktop/portal/documents.
</p>
<p>
This documentation describes version 3 of this interface.
</p>
</div>
<div class="refsect1">
<a name="gdbus-methods-org.freedesktop.portal.Documents"></a><h2>Method Details</h2>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.GetMountPoint"></a><h3>The GetMountPoint() method</h3>
<pre class="programlisting">
GetMountPoint (OUT ay path);
</pre>
<p>
Returns the path at which the document store fuse filesystem
is mounted. This will typically be /run/user/$UID/doc/.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><code class="literal">OUT ay <em class="parameter"><code>path</code></em></code>:</span></p></td>
<td><p>
the path at which the fuse filesystem is mounted
</p></td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.Add"></a><h3>The Add() method</h3>
<pre class="programlisting">
Add (IN  h o_path_fd,
     IN  b reuse_existing,
     IN  b persistent,
     OUT s doc_id);
</pre>
<p>
Adds a file to the document store. The file is passed in the
form of an open file descriptor to prove that the caller has
access to the file.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN h <em class="parameter"><code>o_path_fd</code></em></code>:</span></p></td>
<td><p>
open file descriptor for the file to add
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN b <em class="parameter"><code>reuse_existing</code></em></code>:</span></p></td>
<td><p>
whether to reuse an existing document store entry for the file
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN b <em class="parameter"><code>persistent</code></em></code>:</span></p></td>
<td><p>
whether to add the file only for this session or permanently
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.AddNamed"></a><h3>The AddNamed() method</h3>
<pre class="programlisting">
AddNamed (IN  h  o_path_parent_fd,
          IN  ay filename,
          IN  b  reuse_existing,
          IN  b  persistent,
          OUT s  doc_id);
</pre>
<p>
Creates an entry in the document store for writing a new file.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN h <em class="parameter"><code>o_path_parent_fd</code></em></code>:</span></p></td>
<td><p>
open file descriptor for the parent directory
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN ay <em class="parameter"><code>filename</code></em></code>:</span></p></td>
<td><p>
the basename for the file
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN b <em class="parameter"><code>reuse_existing</code></em></code>:</span></p></td>
<td><p>
whether to reuse an existing document store entry for the file
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN b <em class="parameter"><code>persistent</code></em></code>:</span></p></td>
<td><p>
whether to add the file only for this session or permanently
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.AddFull"></a><h3>The AddFull() method</h3>
<pre class="programlisting">
AddFull (IN  ah    o_path_fds,
         IN  u     flags,
         IN  s     app_id,
         IN  as    permissions,
         OUT as    doc_ids,
         OUT a{sv} extra_out);
</pre>
<p>
Adds multiple files to the document store. The file is passed in the
form of an open file descriptor to prove that the caller has
access to the file.
</p>
<p>
If the as-needed-by-app flag is given, files will only be added to
the document store if the application does not already have access to them.
For files that are not added to the document store, the doc_ids array will
contain an empty string.
</p>
<p>
Additionally, if app_id is specified, it will be given the permissions
listed in GrantPermission.
</p>
<p>
The method also returns some extra info that can be used to avoid
multiple roundtrips. For now it only contains as "mountpoint", the
fuse mountpoint of the document portal.
</p>
<p>
This method was added in version 2 of the org.freedesktop.portal.Documents interface.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN ah <em class="parameter"><code>o_path_fds</code></em></code>:</span></p></td>
<td><p>
open file descriptors for the files to export
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN u <em class="parameter"><code>flags</code></em></code>:</span></p></td>
<td><p>
flags, 1 == reuse_existing, 2 == persistent, 4 == as-needed-by-app
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>app_id</code></em></code>:</span></p></td>
<td><p>
an application ID, or empty string
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN as <em class="parameter"><code>permissions</code></em></code>:</span></p></td>
<td><p>
the permissions to grant, possible values are 'read', 'write', 'grant-permissions' and 'delete'
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT as <em class="parameter"><code>doc_ids</code></em></code>:</span></p></td>
<td><p>
the IDs of the files in the document store
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT a{sv} <em class="parameter"><code>extra_out</code></em></code>:</span></p></td>
<td>
<p>
</p>
<p>
</p>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.AddNamedFull"></a><h3>The AddNamedFull() method</h3>
<pre class="programlisting">
AddNamedFull (IN  h     o_path_fd,
              IN  ay    filename,
              IN  u     flags,
              IN  s     app_id,
              IN  as    permissions,
              OUT s     doc_id,
              OUT a{sv} extra_out);
</pre>
<p>
Creates an entry in the document store for writing a new file.
</p>
<p>
If the as-needed-by-app flag is given, file will only be added to
the document store if the application does not already have access to it.
For file that is not added to the document store, the doc_id will
contain an empty string.
</p>
<p>
Additionally, if app_id is specified, it will be given the permissions
listed in GrantPermission.
</p>
<p>
The method also returns some extra info that can be used to avoid
multiple roundtrips. For now it only contains as "mountpoint", the
fuse mountpoint of the document portal.
</p>
<p>
This method was added in version 3 of the org.freedesktop.portal.Documents interface.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN h <em class="parameter"><code>o_path_fd</code></em></code>:</span></p></td>
<td>
<p>
</p>
<p>
</p>
</td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN ay <em class="parameter"><code>filename</code></em></code>:</span></p></td>
<td><p>
the basename for the file
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN u <em class="parameter"><code>flags</code></em></code>:</span></p></td>
<td><p>
flags, 1 == reuse_existing, 2 == persistent, 4 == as-needed-by-app
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>app_id</code></em></code>:</span></p></td>
<td><p>
an application ID, or empty string
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN as <em class="parameter"><code>permissions</code></em></code>:</span></p></td>
<td><p>
the permissions to grant, possible values are 'read', 'write', 'grant-permissions' and 'delete'
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT a{sv} <em class="parameter"><code>extra_out</code></em></code>:</span></p></td>
<td>
<p>
</p>
<p>
</p>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.GrantPermissions"></a><h3>The GrantPermissions() method</h3>
<pre class="programlisting">
GrantPermissions (IN  s  doc_id,
                  IN  s  app_id,
                  IN  as permissions);
</pre>
<p>
Grants access permissions for a file in the document store
to an application.
</p>
<p>
This call is available inside the sandbox if the application
has the 'grant-permissions' permission for the document.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>app_id</code></em></code>:</span></p></td>
<td><p>
the ID of the application to which permissions are granted
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN as <em class="parameter"><code>permissions</code></em></code>:</span></p></td>
<td><p>
the permissions to grant, possible values are 'read', 'write', 'grant-permissions' and 'delete'
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.RevokePermissions"></a><h3>The RevokePermissions() method</h3>
<pre class="programlisting">
RevokePermissions (IN  s  doc_id,
                   IN  s  app_id,
                   IN  as permissions);
</pre>
<p>
Revokes access permissions for a file in the document store
from an application.
</p>
<p>
This call is available inside the sandbox if the application
has the 'grant-permissions' permission for the document.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>app_id</code></em></code>:</span></p></td>
<td><p>
the ID of the application from which permissions are revoked
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">IN as <em class="parameter"><code>permissions</code></em></code>:</span></p></td>
<td><p>
the permissions to revoke, possible values are 'read', 'write', 'grant-permissions' and 'delete'
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.Delete"></a><h3>The Delete() method</h3>
<pre class="programlisting">
Delete (IN  s doc_id);
</pre>
<p>
Removes an entry from the document store. The file itself is
not deleted.
</p>
<p>
This call is available inside the sandbox if the application
has the 'delete' permission for the document.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.Lookup"></a><h3>The Lookup() method</h3>
<pre class="programlisting">
Lookup (IN  ay filename,
        OUT s  doc_id);
</pre>
<p>
Looks up the document ID for a file.
</p>
<p>
This call is not available inside the sandbox.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN ay <em class="parameter"><code>filename</code></em></code>:</span></p></td>
<td><p>
a path in the host filesystem
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store, or '' if the file is not in the document store
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.Info"></a><h3>The Info() method</h3>
<pre class="programlisting">
Info (IN  s      doc_id,
      OUT ay     path,
      OUT a{sas} apps);
</pre>
<p>
Gets the filesystem path and application permissions for a document store
entry.
</p>
<p>
This call is not available inside the sandbox.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>doc_id</code></em></code>:</span></p></td>
<td><p>
the ID of the file in the document store
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT ay <em class="parameter"><code>path</code></em></code>:</span></p></td>
<td><p>
the path for the file in the host filesystem
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT a{sas} <em class="parameter"><code>apps</code></em></code>:</span></p></td>
<td><p>
a dictionary mapping application IDs to the permissions for that application
</p></td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gdbus-method-org-freedesktop-portal-Documents.List"></a><h3>The List() method</h3>
<pre class="programlisting">
List (IN  s      app_id,
      OUT a{say} docs);
</pre>
<p>
Lists documents in the document store for an application (or for
all applications).
</p>
<p>
This call is not available inside the sandbox.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><code class="literal">IN s <em class="parameter"><code>app_id</code></em></code>:</span></p></td>
<td><p>
an application ID, or '' to list all documents
</p></td>
</tr>
<tr>
<td><p><span class="term"><code class="literal">OUT a{say} <em class="parameter"><code>docs</code></em></code>:</span></p></td>
<td><p>
a dictonary mapping document IDs to their filesystem path
</p></td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div class="refsect1">
<a name="gdbus-properties-org.freedesktop.portal.Documents"></a><h2>Property Details</h2>
<div class="refsect2">
<a name="gdbus-property-org-freedesktop-portal-Documents.version"></a><h3>The "version" property</h3>
<pre class="programlisting">
version  readable   u
</pre>
<p>
</p>
<p>
</p>
</div>
</div>
</div>
<div class="footer">
<hr>Generated by GTK-Doc V1.33.1</div>
</body>
</html>